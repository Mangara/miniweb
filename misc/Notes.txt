- Other HTML minifier with very good ideas:

https://github.com/kangax/html-minifier

http://perfectionkills.com/experimenting-with-html-minifier/ (2010)
http://perfectionkills.com/html-minifier-revisited/          (2014)

- Steal test cases:

https://github.com/kangax/html-minifier/blob/gh-pages/tests/minifier.js

- A good reference for when omitting quotes on attributes is okay:

https://mathiasbynens.be/notes/unquoted-attribute-values

"A valid unquoted attribute value in HTML is any string of text that is not the empty string and that doesnâ€™t contain spaces, tabs, line feeds, form feeds, carriage returns, ", ', `, =, <, or >."

Regex (mine): [^ \t\n\r\f"'`=<>]+

- Encoding class names and ids:

Syntax: [a-z][a-z0-9_-]

If there are fewer than 26, we can use a single letter for each. Otherwise, to make the tree optimal, the number of nodes left at the last stage needs to be 26. Thus, the total number of nodes should be (26 mod 37). In other words, we need to add dummy elements until we have this many.

if n > 26 then
  x = n mod 37

  if x > 26 then
    add 26 + (37 - x) dummy elements
  else
    add 26 - x dummy elements
  fi
fi
